SMTable=jQuery.fn.extend({SmartTable:function(f){$.extend(SMTable,{redraw:function(){v(f,$(this))},destroy:function(){$(this).empty()}});var d=function(t,n){var i=t.find(".headarea > .lengthinputcont > .lengthinput"),a=t.find(".headarea > .orderinputcont > .orderinput"),l=t.find(".headarea > .ordertypeinputcont > .ordertypeinput"),e=t.find(".headarea > .viewtypecont > .viewtypeinput"),r=t.find(".headarea > .searchtablecont > .searchtable"),s=t.find(".pagination");i.off("change").on("change",function(){s.empty();var a=n;a.length=i.val(),a.draw=1,a.start=0,v(a,t)}),a.off("change").on("change",function(){var a=$(this).val();s.empty();var e=n;e.length=i.val(),e.draw=1,e.start=0,e.order.column=a,e.order.dir=l.val(),v(e,t)}),l.off("change").on("change",function(){s.empty();var a=n;a.length=parseInt(i.val()),a.draw=1,a.start=0,a.order.dir=$(this).val(),v(a,t)}),e.off("change").on("change",function(){t.find("table").find("tbody").empty(),s.empty();var a=n;a.length=parseInt(i.val()),a.draw=1,a.start=0,a.dataview=$(this).val(),t.empty(),c(t,n),v(n,t,d(t,n))});var o=!0;r.off("input").on("input",function(a){var e=n;e.length=parseInt(i.val()),e.draw=1,e.start=0,e.search.value=$(this).val(),o&&clearTimeout(o),o=setTimeout(function(){s.empty(),v(e,t)},1e3)})};function v(c,p,a){var h=c.columns,e=c.ajax.url,t=c.ajax.method;$.ajax({url:e,method:t,data:c,success:function(a){var e=JSON.parse(a),t=e.recordsFiltered,n=c.dataview,l=parseInt($(".lengthinput").val()),r=0;if(r=t%l==0?parseInt(t/l):parseInt(t/l)+1,"table"==n){var s="<tbody>",o=e.data;$.each(o,function(a,t){s+="<tr>",$.each(h,function(a,e){c.hiddenOnTable||(s+="<td>"+t[e.data]+"</td>")}),s+="</tr>"}),s+="</tbody>",0<p.find("table").find("tbody").length?p.find("table").find("tbody").replaceWith(s):p.find("table").append(s)}else if("grid"==n){s="",o=e.data;if($.each(o,function(a,t){s+="<li>",$.each(h,function(a,e){e.hiddenOnGrid||(c.ongridview.removeheaders?s+="<div>"+t[e.data]+"</div>":s+="<div>"+e.name+": "+t[e.data]+"</div>")}),s+="</li>"}),0<p.find(".gridcontainer").find("ul.table").children().length){var d='<div class="gridcontainer"><ul class="table '+(p.attr("class")+"_smtable")+'" type="text">'+s+"</ul></div>";p.find(".gridcontainer").replaceWith(d)}else p.find("ul.table").append(s)}!function(a,e,l){1==a?l.find(".pagination").append('<li class="page-item prev disabled"><a class="page-link prev" href="#">Previous</a></li>'):l.find(".pagination").append('<li class="page-item prev"><a class="page-link prev" href="#">Previous</a></li>');for(i=0;i<e;i++)i+1==a?l.find(".pagination").append('<li class="page-item active"><a class="page-link" href="#">'+(i+1)+"</a></li>"):l.find(".pagination").append('<li class="page-item"><a class="page-link" href="#">'+(i+1)+"</a></li>");a==e?l.find(".pagination").append('<li class="page-item next disabled"><a class="page-link next" href="#">Next</a></li>'):l.find(".pagination").append('<li class="page-item next"><a class="page-link next" href="#">Next</a></li>');$(".page-link").off("click").on("click",function(){var a=parseInt($(".page-item.active > a").html()),e=parseInt($(this).html());if(a!=e){if(l.find(".pagination").empty(),$(this).hasClass("prev"))var t=a-1;else if($(this).hasClass("next")){var t=a+1;console.log(t)}else var t=$(this).html();var n=(t-1)*$(".lengthinput").val(),i=f;i.draw=t,i.start=n,i.length=$(".lengthinput").val(),v(i,l)}})}(c.draw,r,p)}})}function c(a,e){console.log(e);var t=e.lengthinput,n=e.length,i=e.dataview,l=e.columns,r='<div class="headarea">';e.actions.length&&(r+='<label class="lengthinputcont">Length: <select class="form-control lengthinput" type="text">',$.each(t,function(a,e){r+='<option value="'+e+'">'+e+"</option>"}),r+="</select></label>"),e.actions.order&&(r+='<label class="orderinputcont">Order by: <select class="form-control orderinput" type="text">',$.each(l,function(a,e){"true"==e.orderable&&(r+='<option value="'+a+'">'+e.data+"</option>")}),r+="</select></label>",r+='<label class="ordertypeinputcont">Order dir: <select class="form-control ordertypeinput" type="text">',r+='<option value="asc">asc</option>',r+='<option value="desc">desc</option>',r+="</select></label>"),e.actions.view&&(r+='<label class="viewtypecont">View: <select class="form-control viewtypeinput" type="text">',r+='<option value="table">table</option>',r+='<option value="grid">grid</option>',r+="</select></label>"),e.actions.search&&(r+='<label class="searchtablecont"><input class="form-control searchtable" placeholder="Search"  type="text"></label>'),r+="</div>";var s=a.attr("class")+"_smtable";"table"==i?r+='<table class="table '+s+' table-bordered" type="text"></table>':"grid"==i&&(r+='<div class="gridcontainer"><ul class="table '+s+'" type="text"></ul></div>'),r+='<div class="tablefooterarea"><nav aria-label="Page navigation example"><ul class="pagination"></ul></nav></div>',a.append(r),$(".lengthinput").val(n),$(".viewtypeinput").val(e.dataview),"table"==i&&function(a,e){cols=e.columns,ordercol=e.order.column,a.find("thead").append("<tr>");var t="<thead class='thead-light'><tr>";$.each(cols,function(a,e){t+="<th style='width:"+e.width+"'>",t+="<a  data='"+a+"' class='headerlinks'>"+e.name+"</a>",t+="</th>"}),t+="</tr></thead>",0==a.find("table").find("thead").length&&a.find("table").append(t)}(a,e)}return this.each(function(){var a=$(this);f.draw=1,f.start=0,f.search={},f.search.value="",f.search.regex="false",c(a,f),v(f,a,d(a,f))})}});
