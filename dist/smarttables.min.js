SMTable=jQuery.fn.extend({SmartTable:function(f){$.extend(SMTable,{redraw:function(){u(f,$(this))},destroy:function(){$(this).empty()}});var s=function(t,n){var i=t.find(".headarea > .lengthinputcont > .lengthinput"),e=t.find(".headarea > .orderinputcont > .orderinput"),l=t.find(".headarea > .ordertypeinputcont > .ordertypeinput"),a=t.find(".headarea > .viewtypecont > .viewtypeinput"),r=t.find(".headarea > .searchtablecont > .searchtable"),d=t.find(".pagination");i.off("change").on("change",function(){d.empty();var e=n;return e.length=i.val(),e.draw=1,e.start=0,u(e,t),!1}),e.off("change").on("change",function(){var e=$(this).val();d.empty();var a=n;return a.length=i.val(),a.draw=1,a.start=0,a.order.column=e,a.order.dir=l.val(),u(a,t),!1}),l.off("change").on("change",function(){d.empty();var e=n;return e.length=parseInt(i.val()),e.draw=1,e.start=0,e.order.dir=$(this).val(),u(e,t),!1}),a.off("change").on("change",function(){t.find("table").find("tbody").empty(),d.empty();var e=n;return e.length=parseInt(i.val()),e.draw=1,e.start=0,e.dataview=$(this).val(),t.empty(),c(t,n),u(n,t,s(t,n)),!1});var o=!0;r.off("input").on("input",function(e){var a=n;return a.length=parseInt(i.val()),a.draw=1,a.start=0,a.search.value=$(this).val(),o&&clearTimeout(o),o=setTimeout(function(){d.empty(),u(a,t)},1e3),!1}),null!=n.onInitComplete&&n.onInitComplete()};function u(c,p,e){var h=c.columns,a=c.ajax.url,t=c.ajax.method,n=Object.assign({},c);n.onInitComplete=null,n.onDrawUpdated=null,$.ajax({url:a,method:t,data:n,success:function(e){var a=JSON.parse(e),t=a.recordsFiltered,n=c.dataview,l=parseInt(p.find(".headarea > .lengthinputcont > .lengthinput").val()),r=0;if(r=t%l==0?parseInt(t/l):parseInt(t/l)+1,"table"==n){var d="<tbody>",o=a.data;$.each(o,function(e,t){d+="<tr>",$.each(h,function(e,a){c.hiddenOnTable||(d+="<td>"+t[a.data]+"</td>")}),d+="</tr>"}),d+="</tbody>",0<p.find("table").find("tbody").length?p.find("table").find("tbody").replaceWith(d):p.find("table").append(d)}else if("grid"==n){d="",o=a.data;if($.each(o,function(e,t){d+="<li>",$.each(h,function(e,a){a.hiddenOnGrid||(c.ongridview.removeheaders?d+="<div>"+t[a.data]+"</div>":d+="<div>"+a.name+": "+t[a.data]+"</div>")}),d+="</li>"}),0<p.find(".gridcontainer").find("ul.table").children().length){var s='<div class="gridcontainer"><ul class="table '+(p.attr("class")+"_smtable")+'" type="text">'+d+"</ul></div>";p.find(".gridcontainer").replaceWith(s)}else p.find("ul.table").append(d)}!function(e,a,l){1==e?l.find(".pagination").append('<li class="page-item prev disabled"><a class="page-link prev" href="#">Previous</a></li>'):l.find(".pagination").append('<li class="page-item prev"><a class="page-link prev" href="#">Previous</a></li>');for(i=0;i<a;i++)i+1==e?l.find(".pagination").append('<li class="page-item active"><a class="page-link" href="#">'+(i+1)+"</a></li>"):l.find(".pagination").append('<li class="page-item"><a class="page-link" href="#">'+(i+1)+"</a></li>");e==a?l.find(".pagination").append('<li class="page-item next disabled"><a class="page-link next" href="#">Next</a></li>'):l.find(".pagination").append('<li class="page-item next"><a class="page-link next" href="#">Next</a></li>');l.find(".pagination").find(".page-item").find(".page-link").off("click").on("click",function(){var e=parseInt(l.find(".pagination").find(".page-item").find(".page-item.active > a").html()),a=parseInt($(this).html());if(e!=a){if(l.find(".pagination").empty(),$(this).hasClass("prev"))var t=e-1;else if($(this).hasClass("next")){var t=e+1;console.log(t)}else var t=$(this).html();var n=(t-1)*l.find(".headarea > .lengthinputcont > .lengthinput").val(),i=f;return i.draw=t,i.start=n,i.length=l.find(".headarea > .lengthinputcont > .lengthinput").val(),u(i,l),!1}})}(c.draw,r,p),null!=c.onDrawUpdated&&c.onDrawUpdated()}})}function c(e,a){e.addClass("smarttable");var t=a.lengthinput,n=a.length,i=a.dataview,l=a.columns,r='<div class="headarea">';a.actions.length&&(r+='<label class="lengthinputcont">Length: <select class="form-control lengthinput" type="text">',$.each(t,function(e,a){r+='<option value="'+a+'">'+a+"</option>"}),r+="</select></label>"),a.actions.order&&(r+='<label class="orderinputcont">Order by: <select class="form-control orderinput" type="text">',$.each(l,function(e,a){"true"==a.orderable&&(r+='<option value="'+e+'">'+a.data+"</option>")}),r+="</select></label>",r+='<label class="ordertypeinputcont">Order dir: <select class="form-control ordertypeinput" type="text">',r+='<option value="asc">asc</option>',r+='<option value="desc">desc</option>',r+="</select></label>"),a.actions.view&&(r+='<label class="viewtypecont">View: <select class="form-control viewtypeinput" type="text">',r+='<option value="table">table</option>',r+='<option value="grid">grid</option>',r+="</select></label>"),a.actions.search&&(r+='<label class="searchtablecont"><input class="form-control searchtable" placeholder="Search"  type="text"></label>'),r+="</div>";var d=e.attr("class")+"_smtable";"table"==i?r+='<table class="table '+d+' table-bordered" type="text"></table>':"grid"==i&&(r+='<div class="gridcontainer"><ul class="table '+d+'" type="text"></ul></div>'),r+='<div class="tablefooterarea"><nav aria-label="Page navigation example"><ul class="pagination"></ul></nav></div>',e.append(r),e.find(".headarea > .lengthinputcont > .lengthinput").val(n),$(".viewtypeinput").val(a.dataview),"table"==i&&function(e,a){cols=a.columns,ordercol=a.order.column,e.find("thead").append("<tr>");var t="<thead class='thead-light'><tr>";$.each(cols,function(e,a){t+="<th style='width:"+a.width+"'>",t+="<a  data='"+e+"' class='headerlinks'>"+a.name+"</a>",t+="</th>"}),t+="</tr></thead>",0==e.find("table").find("thead").length&&e.find("table").append(t)}(e,a)}return this.each(function(){var e=$(this);f.draw=1,f.start=0,f.search={},f.search.value="",f.search.regex="false",c(e,f),u(f,e,s(e,f))})}});
